<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <!-- This Liquibase file is meant to contain changesets for Visit Related Information Only -->
        
    <changeSet id="SEARCH-OMRS-V-001" author="tw">
        <comment>Create new visit type for IPD</comment>
        <insert tableName="visit_type">
            <column name="name" value="IPD" />
            <column name="description" value="Visit for patients being admitted" />
            <column name="creator" value="1" />
            <column name="uuid" valueComputed="uuid()" />
            <column name="date_created" valueDate="CURRENT_TIMESTAMP" />
        </insert>
    </changeSet>

    <changeSet id="SEARCH-OMRS-V-002" author="tw">
        <comment>Create new visit type for OPD</comment>
        <insert tableName="visit_type">
            <column name="name" value="OPD" />
            <column name="description" value="Visit for patients coming for OPD" />
            <column name="creator" value="1" />
            <column name="uuid" valueComputed="uuid()" />
            <column name="date_created" valueDate="CURRENT_TIMESTAMP" />
        </insert>
    </changeSet>

    <changeSet id="SEARCH-OMRS-V-003" author="tw">
        <comment>Add global property to configure visit auto expire hours</comment>
        <sql>
            INSERT INTO global_property (`property`, `property_value`, `description`, `uuid`)
            VALUES ('emrapi.visitExpireHours', '24', 'Number of hours after which visit can be auto closed', uuid())
            ON DUPLICATE KEY UPDATE property_value = '24';
        </sql>
    </changeSet>

    <changeSet id="SEARCH-OMRS-V-004" author="tw">
        <comment>Comma seperated list of visits which much be closed automatically</comment>
        <sql>
            INSERT INTO global_property (`property`, `property_value`, `description`, `uuid`)
            VALUES ('visits.autoCloseVisitType', 'OPD', 'comma-separated list of the visit type(s) to automatically close', uuid())
            ON DUPLICATE KEY UPDATE property_value = 'OPD';
        </sql>
    </changeSet>


</databaseChangeLog>